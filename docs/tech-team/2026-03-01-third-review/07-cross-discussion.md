# äº¤äº’è¨è«–è¨˜éŒ„ â€” ç¬¬ä¸‰æ¬¡å…¨é¢è©•ä¼°

**æ—¥æœŸ**: 2026-03-01
**åƒèˆ‡è€…**: è³‡å®‰ã€æ•ˆèƒ½ã€SOLIDã€æ¶æ§‹ã€ç¨‹å¼å“è³ªã€å¯ç¶­è­·æ€§ å…­ä½ Agent

---

## è¨è«–æ‘˜è¦

å…­ä»½å ±å‘Šå®Œæˆå¾Œï¼Œå„ Agent å°±å½¼æ­¤çš„ç™¼ç¾é€²è¡Œäº¤å‰è¨è«–ï¼Œä¸‹æ–‡è¨˜éŒ„ä¸»è¦äº¤äº’æ„è¦‹ã€‚

---

## è­°é¡Œä¸€ï¼š`article.ts` â€” å…±åŒçš„æ ¸å¿ƒå•é¡Œ

### è³‡å®‰ Agent â†’ SOLID Agent

> ã€Œä½ åœ¨ SOLID-02 æŒ‡å‡º `createArticle()` çš„ ID ç”Ÿæˆæ˜¯ DRY é•åã€‚å¾è³‡å®‰è§’åº¦ï¼Œæˆ‘æ›´æ“”å¿ƒ `Math.random()` çš„å¯é æ¸¬æ€§ã€‚é›–ç„¶æ–‡ç«  ID ä¸æ˜¯å®‰å…¨æ†‘è­‰ï¼Œä½†è‹¥ ID è¢«ç”¨åœ¨å…¬é–‹ URL æˆ–åˆ†äº«é€£çµï¼Œéç¢ºå®šæ€§çš„ ID è‡³å°‘è¦æ˜¯æœ‰è¶³å¤ ç†µçš„ã€‚sha256(filePath) çš„æ–¹å¼æ¯” `Date.now() + Math.random()` åœ¨å¤šå€‹ç¶­åº¦éƒ½æ›´å„ªï¼šç¢ºå®šæ€§ã€å¯é‡ç¾ã€è¶³å¤ å”¯ä¸€ã€‚**é€™å€‹ä¿®æ­£æ˜¯é«˜å„ªå…ˆçš„**ï¼Œè€Œéåƒ…æ˜¯ DRY å•é¡Œã€‚ã€

### SOLID Agent â†’ æ•ˆèƒ½ Agent

> ã€Œä½ ç™¼ç¾ `setupFileWatching()` çš„è¨‚é–±æ´©æ¼ï¼ˆP-01/P-06ï¼‰ï¼Œæˆ‘åœ¨ SOLID-01 å°‡å®ƒåˆ—ç‚º SRP é•åã€‚é€™å…©å€‹è¨ºæ–·å…¶å¯¦æ˜¯åŒä¸€å€‹å•é¡Œçš„å…©å€‹é¢å‘ï¼šå› ç‚ºæª”æ¡ˆç›£è½é‚è¼¯è¢«å¡é€² storeï¼Œå®ƒçš„ç”Ÿå‘½é€±æœŸç„¡æ³•è¢«æ­£ç¢ºç®¡ç†ã€‚**å¦‚æœå°‡ `setupFileWatching` æ‹†å‡ºåˆ° `useFileWatching` composable**ï¼Œè¨‚é–±ç®¡ç†å¯ä»¥é€é `onScopeDispose` è‡ªå‹•æ¸…ç†ï¼Œå…©å€‹å•é¡Œä¸€èµ·è§£æ±ºã€‚ã€

### æ•ˆèƒ½ Agent â†’ æ¶æ§‹ Agent

> ã€Œä½ çš„ A-01 æŒ‡å‡º IPC é »é“å­—é¢å­—ä¸²çš„ä¸€è‡´æ€§å•é¡Œã€‚æˆ‘è¦è£œå……ï¼š`start-file-watching` ä½¿ç”¨å­—é¢å­—ä¸²æ„å‘³è‘—æ¡†æ¶ç„¡æ³•å°é€™äº› IPC å‘¼å«çš„å›æ‡‰æˆæœ¬é€²è¡Œçµ±è¨ˆæˆ–è¿½è¹¤ã€‚çµ±ä¸€ä½¿ç”¨ IPC å¸¸æ•¸å¾Œï¼Œå·¥å…·éˆå¯ä»¥æ›´å®¹æ˜“åœ° trace æ‰€æœ‰ IPC å‘¼å«è·¯å¾‘ï¼Œé€™å°æ•ˆèƒ½å‰–æï¼ˆprofilingï¼‰å¾ˆé‡è¦ã€‚ã€

### æ¶æ§‹ Agent â†’ è³‡å®‰ Agent

> ã€Œä½ åœ¨ S-03 æåˆ°ç™½åå–®åˆå§‹åŒ–å‰çš„è¦–çª—æœŸã€‚æˆ‘æ³¨æ„åˆ° `main.ts` çš„ IPC handler è·¯ç”±æ˜¯åœ¨ `app.whenReady()` ä¹‹å¾Œç«‹å³å»ºç«‹ã€‚åœ¨éå¸¸å¿«é€Ÿçš„å•Ÿå‹•åºåˆ—ä¸­ï¼Œç†è«–ä¸Š `fileService.setAllowedPaths()` çš„éåŒæ­¥ `await configService.getConfig()` å¯èƒ½æ™šæ–¼ç¬¬ä¸€å€‹ IPC å‘¼å«åˆ°é”ã€‚å»ºè­°çš„ç·©è§£æªæ–½ï¼ˆåœ¨åˆå§‹åŒ–å®Œæˆå‰æ‹’çµ•å±éšªæ“ä½œï¼‰æ˜¯æ­£ç¢ºæ–¹å‘ï¼Œå¯ä»¥ç”¨ä¸€å€‹ `isInitialized` flag æ­é… pending IPC ä½‡åˆ—ä¾†å¯¦ç¾ã€‚ã€

---

## è­°é¡ŒäºŒï¼šéœé»˜å¤±æ•— â€” è¡Œç‚ºè·¨å ±å‘Šè¨è«–

### ç¨‹å¼å“è³ª Agent â†’ è³‡å®‰ Agent

> ã€Œæˆ‘åœ¨ Q-02 åˆ—å‡ºä¸‰è™•éœé»˜åå’½éŒ¯èª¤ã€‚ä½ åœ¨ S-05 ä¹Ÿç™¼ç¾äº† `searchService.updateFile().catch(() => {})`ã€‚æœ‰è¶£çš„æ˜¯ï¼Œé€™å€‹æ¨¡å¼åœ¨ç¨‹å¼åº«ä¸­åè¦†å‡ºç¾â€”â€”æ„Ÿè¦ºæ˜¯ä¸€å€‹é–‹ç™¼ç¿’æ…£è€Œéå€‹åˆ¥ç–å¿½ã€‚å»ºè­°åœ¨ CONTRIBUTING.md æˆ– DEVELOPMENT.md ä¸­åŠ å…¥ã€ç¦æ­¢ `.catch(() => {})` ç©ºè™•ç†å™¨ã€çš„æ˜æ–‡è¦å®šï¼Œè®“ ESLint ä¹Ÿè¨±å¯ä»¥ç”¨ `no-empty-function` è¦å‰‡é…åˆ `promise` é¸é …ä¾†éœæ…‹åµæ¸¬ã€‚ã€

### è³‡å®‰ Agent â†’ ç¨‹å¼å“è³ª Agent

> ã€ŒåŒæ„ã€‚ç‰¹åˆ¥æ˜¯ `searchBuildIndex?.()?.catch(() => {})` é€™è¡Œâ€”â€”ä½¿ç”¨äº†å¯é¸éˆï¼ˆ`?.`ï¼‰ä¾†é˜²ç¯„ API ä¸å­˜åœ¨çš„æƒ…æ³ï¼Œé€™æœ¬èº«æ˜¯è¬¹æ…çš„é˜²ç¦¦åšæ³•ï¼Œä½†åŒæ™‚çš„ `.catch(() => {})` å»å°‡æ‰€æœ‰ä¸‹è¡ŒéŒ¯èª¤éƒ½åæ‰ã€‚é€™å€‹æ¨¡å¼èƒŒå¾Œçš„æ„åœ–æ˜¯ã€éåŒæ­¥çš„éé—œéµæ“ä½œï¼Œä¸æƒ³é˜»å¡ä¸»æµç¨‹ã€ï¼Œä½†è§£æ±ºæ–¹æ¡ˆä¸æ˜¯åå’½ï¼Œè€Œæ˜¯ fire-and-logï¼š`.catch(err => logger.warn(...))`ã€‚ã€

### å¯ç¶­è­·æ€§ Agent â†’ ç¨‹å¼å“è³ª Agent

> ã€Œåœ¨å¯ç¶­è­·æ€§è§’åº¦ï¼Œéœé»˜å¤±æ•—æœ€å¤§çš„æˆæœ¬æ˜¯**é™¤éŒ¯æ™‚é–“**ã€‚ä¸€å€‹å¤±æ•ˆçš„åŠŸèƒ½ï¼ˆå¦‚æœå°‹ï¼‰ï¼Œå¯èƒ½éœ€è¦æ•¸å°æ™‚æ‰èƒ½è¿½è¹¤åˆ°æ˜¯ç´¢å¼•å»ºç«‹æ™‚éœé»˜å¤±æ•—ã€‚å¦‚æœæœ‰ logï¼Œ5 åˆ†é˜å°±èƒ½å®šä½ã€‚é€™æ˜¯æŠ€è¡“å‚µçš„éš±æ€§æˆæœ¬ï¼Œæ¯”ä¿®å¾©éœé»˜å¤±æ•—æœ¬èº«æ›´è²´ã€‚ã€

---

## è­°é¡Œä¸‰ï¼š`FileService.getFileStats()` æœªé©—è­‰è·¯å¾‘

### æ¶æ§‹ Agent â†’ è³‡å®‰ Agent

> ã€Œä½ çš„ S-01 å¾ˆé‡è¦ã€‚ä½†æˆ‘æƒ³è£œå……æ¶æ§‹è§’åº¦çš„è§€å¯Ÿï¼š`getFileStats()` åœ¨ `loadAllArticles()` ä¸­è¢«å¤§é‡å‘¼å«ï¼ˆæ¯å€‹ç›®éŒ„æ¢ç›®ä¸€æ¬¡ï¼‰ã€‚å¦‚æœåŠ å…¥ `validatePath()` é©—è­‰ï¼Œè€Œ `validatePath()` æ˜¯æ¯”è¼ƒè¤‡é›œçš„è·¯å¾‘æ­£è¦åŒ–æ“ä½œï¼Œé€™æœƒæ”¾å¤§ P-02 ä¸­å·²æè¿°çš„ IPC ä¸²è¯æ•ˆèƒ½å•é¡Œã€‚**è§£æ±ºæ–¹æ¡ˆå»ºè­°**ï¼šåœ¨å·²çŸ¥å®‰å…¨ä¸Šä¸‹æ–‡ï¼ˆ`ArticleService.loadAllArticles` å…§ï¼‰çš„ `getFileStats` å‘¼å«å¯ä½¿ç”¨ `skipValidation` é¸é …ï¼Œä½†é€é IPC æš´éœ²çš„å…¬é–‹è·¯å¾‘å¿…é ˆé©—è­‰ã€‚é€™éœ€è¦å…©ç¨®ä¸åŒçš„ `getFileStats` å‘¼å«æ¨¡å¼ã€‚ã€

### è³‡å®‰ Agent â†’ æ¶æ§‹ Agent

> ã€Œä½ çš„åˆ†ææ­£ç¢ºï¼Œä½†æˆ‘æŒè¬¹æ…æ…‹åº¦ã€‚`skipValidation` é¸é …æ˜¯ä¸€å€‹å¯ä»¥è¢«æ¿«ç”¨çš„ escape hatchã€‚æ›´å¥½çš„æ–¹å¼ä¹Ÿè¨±æ˜¯åœ¨ `FileService` å±¤é¢åŠ å…¥ä¸€å€‹ `trustedContext` æ¦‚å¿µï¼šåœ¨ main.ts åˆå§‹åŒ–æ™‚çš„ç›´æ¥å‘¼å«ä½¿ç”¨ä¿¡ä»»è·¯å¾‘ï¼Œé€é IPC ä¾†çš„å‘¼å«ä¸€å¾‹é©—è­‰ã€‚é€™æ¨£é©—è­‰è¦æ±‚ä¸ä¾è³´å‘¼å«è€…çš„è‡ªå¾‹ã€‚ã€

### æ•ˆèƒ½ Agent â†’ è³‡å®‰ Agent + æ¶æ§‹ Agent

> ã€Œå…©ä½çš„è¨è«–è§¸åŠçœŸæ­£çš„è¨­è¨ˆå¼µåŠ›ã€‚æˆ‘çš„æè­°ï¼šæœ€æ ¹æœ¬çš„ä¿®æ­£æ˜¯è®“ `readDirectory()` è¿”å›å¸¶æœ‰ `isDirectory` çš„é …ç›®ï¼ˆè¦‹ P-02ï¼‰ï¼Œé€™æ¨£å¯ä»¥æ¸›å°‘ 80% çš„ `getFileStats()` å‘¼å«ã€‚æ¸›å°‘å‘¼å«æ¬¡æ•¸å¾Œï¼Œå°å‰©é¤˜å‘¼å«åŠ é©—è­‰çš„æ•ˆèƒ½æˆæœ¬å°±å¯æ¥å—äº†ã€‚é€™å€‹æ”¹å‹•åŒæ™‚è§£æ±ºäº†æ•ˆèƒ½å•é¡Œå’Œè³‡å®‰å•é¡Œã€‚ã€

---

## è­°é¡Œå››ï¼š`setTimeout(100ms)` çš„è¨­è¨ˆå“²å­¸

### ç¨‹å¼å“è³ª Agent â†’ æ¶æ§‹ Agent

> ã€ŒQ-03 ä¸­çš„ `setTimeout(100ms)` å•é¡Œï¼Œå¾æ¶æ§‹è§’åº¦ä½ æ€éº¼çœ‹ï¼Ÿæˆ‘èªç‚ºé€™æš—ç¤ºäº† store çš„åˆå§‹åŒ–æ™‚åºèˆ‡ Vue çš„ç”Ÿå‘½é€±æœŸ hook æ²’æœ‰å°é½Šã€‚ã€

### æ¶æ§‹ Agent â†’ ç¨‹å¼å“è³ª Agent

> ã€Œæ­£ç¢ºã€‚Pinia store çš„è¨­å®šå‡½å¼ï¼ˆ`setup` storeï¼‰åœ¨å…ƒä»¶æ›è¼‰å‰å°±åŸ·è¡Œäº†ï¼Œå› æ­¤ `loadArticles()` å¯èƒ½åœ¨ç›®æ¨™å…ƒä»¶çš„ `onMounted` ä¹‹å‰å·²å®Œæˆï¼Œ`initializeAutoSave()` çš„ 100ms å»¶é²æ˜¯ç‚ºäº†ç­‰å¾… Vue çš„éŸ¿æ‡‰å¼ç³»çµ±æº–å‚™å¥½ã€‚æ›´ä¹¾æ·¨çš„æ¶æ§‹æ˜¯ï¼šstore å®Œæˆè¼‰å…¥å¾Œ emit ä¸€å€‹äº‹ä»¶ï¼ˆæˆ– return ä¸€å€‹ Promiseï¼‰ï¼Œè®“ä½¿ç”¨ store çš„å…ƒä»¶åœ¨ `onMounted` ä¸­è¨‚é–±ä¸¦åˆå§‹åŒ–è‡ªå‹•å„²å­˜ã€‚é€™æ¨£ç”Ÿå‘½é€±æœŸæ˜¯é¡¯å¼çš„ï¼Œä¸ä¾è³´ä»»æ„çš„æ™‚é–“æ•¸å­—ã€‚ã€

### å¯ç¶­è­·æ€§ Agent

> ã€ŒåŒæ„ã€‚ä»»ä½•åŒ…å«ä»»æ„æ•¸å­—ï¼ˆæ¯”å¦‚ 100msï¼‰çš„ç¨‹å¼ç¢¼ï¼Œåœ¨ 6 å€‹æœˆå¾Œéƒ½ç„¡æ³•ç†è§£ã€ç‚ºä»€éº¼æ˜¯ 100 è€Œä¸æ˜¯ 50 æˆ– 200ã€ã€‚å³ä½¿æœ‰æ³¨è§£ï¼Œä¸‹ä¸€å€‹ç¶­è­·è€…æœƒæ‡·ç–‘é‚£å€‹æ•¸å­—æ˜¯å¦ä»ç„¶æ­£ç¢ºã€‚é¡¯å¼çš„ Promise/event æ¨¡å¼æ˜¯è‡ªæˆ‘æ–‡ä»¶åŒ–çš„ã€‚ã€

---

## è­°é¡Œäº”ï¼šæ•´é«”é€²æ­¥è©•ä¼°

### å¯ç¶­è­·æ€§ Agentï¼ˆä¸»æŒäººç¸½çµï¼‰

> ã€Œæ¯”è¼ƒä¸‰æ¬¡è©•ä¼°çš„è¶¨å‹¢ï¼š
>
> **ç¬¬ä¸€æ¬¡ â†’ ç¬¬äºŒæ¬¡**ï¼šå¤§å¹…é€²æ­¥ï¼ŒFix-01 åˆ° Fix-11 ç³»çµ±æ€§ä¿®å¾©ï¼ŒRefactor-01 åˆ° Refactor-08 æ¶æ§‹é‡çµ„ã€‚
>
> **ç¬¬äºŒæ¬¡ â†’ ç¬¬ä¸‰æ¬¡**ï¼šæœ¬æ¬¡ç™¼ç¾çš„å•é¡Œæ•¸é‡å’Œåš´é‡åº¦éƒ½æ˜é¡¯ä¸‹é™ã€‚é‡å¤§å•é¡Œï¼ˆCritical/Highï¼‰å¾ç¬¬äºŒæ¬¡çš„å¤šå€‹æ¸›å°‘åˆ°æœ¬æ¬¡çš„ 1-2 å€‹ï¼ˆ`setupFileWatching` è¨‚é–±æ´©æ¼ã€`getFileStats` æœªé©—è­‰ï¼‰ã€‚ä¸»è¦å‰©é¤˜å•é¡Œæ˜¯ï¼š
> 1. `article.ts` store è·è²¬æŒçºŒéé‡ï¼ˆæ¯æ¬¡éƒ½ç™¼ç¾ï¼‰
> 2. éœé»˜åå’½éŒ¯èª¤æ¨¡å¼å°šæœªå¾æ–‡åŒ–ä¸Šå®Œå…¨æ¶ˆé™¤
>
> é€™æ˜¯å¥åº·çš„ç³»çµ±ï¼Œé‚„åœ¨æ”¹å–„ä¸­ã€‚ã€

### è³‡å®‰ Agent

> ã€Œæˆ‘è¦å¼·èª¿ï¼š`getFileStats()` æœªé©—è­‰è·¯å¾‘æ˜¯æœ¬æ¬¡å”¯ä¸€æˆ‘èªç‚ºæ‡‰è©²ç«‹å³ä¿®æ­£ï¼ˆç•¶å¤©ä¿®å¾©ï¼‰çš„å•é¡Œã€‚å…¶ä»–å•é¡Œé›–ç„¶é‡è¦ï¼Œä½†ä¸å½±éŸ¿ç•¶å‰ä½¿ç”¨è€…çš„å®‰å…¨ã€‚ã€

### æ•ˆèƒ½ Agent

> ã€Œè¨‚é–±æ´©æ¼ï¼ˆP-01/P-06ï¼‰æ˜¯æˆ‘èªç‚ºæœ€é«˜å„ªå…ˆçš„åŸ·è¡ŒæœŸç©©å®šæ€§å•é¡Œã€‚é•·æ™‚é–“ä½¿ç”¨å¾Œæœƒå‡ºç¾æ˜é¡¯è¡Œç‚ºç•°å¸¸ï¼ˆäº‹ä»¶é‡è¤‡è§¸ç™¼ï¼‰ï¼Œä½¿ç”¨è€…å¯å¯Ÿè¦ºï¼Œæ‡‰åœ¨æœ¬ Sprint ä¿®å¾©ã€‚ã€

### SOLID Agent + ç¨‹å¼å“è³ª Agentï¼ˆè¯åˆè²æ˜ï¼‰

> ã€Œ`createArticle()` çš„ ID ç”Ÿæˆä¸ä¸€è‡´ï¼ˆä½¿ç”¨ `Math.random()` è€Œé `ArticleService.generateId()`ï¼‰æ˜¯æŠ€è¡“å‚µçš„å…¸å‹æ¡ˆä¾‹ï¼šå•é¡Œæœ¬èº«ä¸ç·Šæ€¥ï¼Œä½†éš¨è‘—æ–‡ç«  ID æ ¼å¼ä¸ä¸€è‡´çš„ç´¯ç©ï¼Œæœªä¾†çš„è³‡æ–™é·ç§»å’ŒåŠŸèƒ½é–‹ç™¼æˆæœ¬æœƒè¶Šä¾†è¶Šé«˜ã€‚å»ºè­°åœ¨ä¸‹å€‹ Sprint è™•ç†ï¼Œé¿å…è³‡æ–™æ ¼å¼åˆ†æ­§æŒçºŒæ“´å¤§ã€‚ã€

---

## å…±åŒå»ºè­°çš„è¡Œå‹•æ¸…å–®

ä¾å„ªå…ˆé †åºï¼š

### ğŸ”´ ç«‹å³ï¼ˆç•¶å¤©ï¼‰
1. **[S-01]** `FileService.getFileStats()` åŠ å…¥ `validatePath()` å‘¼å«
2. **[Q-02]** ä¸‰è™•éœé»˜ `.catch(() => {})` æ”¹ç‚º `.catch(err => logger.error(...))`

### ğŸŸ  æœ¬ Sprint
3. **[P-01/P-06]** ä¿®æ­£ `setupFileWatching()` è¨‚é–±æ´©æ¼ï¼ˆè¿”å›å€¼ä¿å­˜ä¸¦åœ¨é‡æ–°å‘¼å«å‰æ¸…ç†ï¼‰
4. **[S-02]** `writeFile()`/`copyFile()` è£œå…… `{ cause: err }`
5. **[SOLID-02/Q-04]** `createArticle()` æ”¹ç”¨ `ArticleService.generateId()`ï¼Œ`substr` â†’ `substring`

### ğŸŸ¡ ä¸‹ Sprint
6. **[A-01]** IPC å­—é¢å­—ä¸²ç§»è‡³å¸¸æ•¸ï¼ˆ`start-file-watching` ç­‰ï¼‰
7. **[SOLID-03]** `parseArticlePath()` ç¡¬ç·¨ç¢¼ "Publish" â†’ `ArticleStatus.Published`
8. **[Q-03]** `setTimeout(100ms)` é‡æ§‹ç‚ºé¡¯å¼ Promise æµç¨‹
9. **[S-04]** `setConfig` IPC handler åŠ å…¥ Zod schema é©—è­‰

### ğŸŸ¢ Backlog
10. **[SOLID-01/M-02]** è©•ä¼° `article.ts` æ‹†åˆ†ï¼š`useFileWatching` composable
11. **[A-02]** `FileService.watchCallback` å‡ç´šç‚ºç™¼å¸ƒ-è¨‚é–±æ¨¡å¼
12. **[M-05]** å»ºç«‹ `VaultConfig` é›†ä¸­ç®¡ç†ç›®éŒ„çµæ§‹å‡è¨­
13. **[Q-01]** ç³»çµ±æ€§æ¶ˆé™¤æ¥­å‹™é‚è¼¯å±¤çš„ `no-explicit-any`

---

*äº¤äº’è¨è«–çµæŸ ï½œ å›è‡³: [ç´¢å¼•](./00-index.md)*
