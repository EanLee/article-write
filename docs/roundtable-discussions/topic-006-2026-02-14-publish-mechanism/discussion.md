# WriteFlow 圓桌會議 #006 — 發布機制落差確認

> **會議日期**: 2026-02-14
> **會議類型**: 緊急機制確認
> **會議編號**: #006
> **參與者**: Alex (PM)、Sam (Tech Lead)、Jordan (QA)、Morgan (UX)
> **主持人**: Alex (PM)
> **觸發原因**: 發現實際發布機制與先前討論不一致，且關鍵設計決策從未文件化

---

## 📋 會議議程

1. **問題陳述** — 哪裡不一樣
2. **各角色確認現況** — 從各自視角理解落差
3. **核心議題討論** — 三個待確認的設計決策
4. **決策與行動計畫**

---

## 🎯 Part 1：問題陳述（Alex, PM）

**Alex**：今天緊急召開這個會議，是因為我在檢視文件的時候發現一件事——

我們在圓桌 #005 討論的「發布機制」，和程式碼裡實際的行為不一樣。

具體來說，`b0b8b53` 這個 commit 把 `target` 的語意從「Astro 專案根目錄」改成「直接指向 content 資料夾」。E2E_PUBLISH_FLOW.md 沒有更新，圖片的路徑邏輯也沒有跟著改。

但我想說的不只是這個 bug。更大的問題是：**「發布」這件事的設計哲學，從來沒有被正式說清楚過**。我們每個人對「發布」的理解可能都不一樣。今天就是要把這件事說清楚。

---

## 💬 Part 2：各角色確認現況

---

### 🟥 Sam（Tech Lead）— 技術現況說明

**Sam**：讓我先說清楚目前程式碼的狀態。

`b0b8b53` 那個 commit 確實是我做的。當時的判斷是：讓使用者直接指定 content 資料夾比較直覺，不需要讓他們知道 Astro 的內部結構。所以我把路徑邏輯簡化了。

問題是，圖片的輸出路徑我沒有一起改。文章改到對的位置了，但圖片還在用舊的邏輯——會被丟到一個不存在的地方。這是我的失誤，我承認。

另外，我也意識到一個更根本的問題：目前編輯器上方有「發布到部落格」按鈕，文章列表每篇也有，這暗示的是「單篇發布」的概念。但如果發布是「全量同步」，這些按鈕放在那裡就是誤導。

**立場**：⚠️ 條件支持現有方向，但需要先對齊「發布是什麼」這個定義。

---

### 🟩 Jordan（QA）— 測試覆蓋視角

**Jordan**：我想從測試的角度說幾件事。

首先，圖片路徑的 bug 到現在沒被發現，是因為我們完全沒有跑過端到端的發布流程。Unit test 都是 mock 的，沒有真實的檔案系統操作。這個風險在 #005 就提過了，現在確認了——mock 測試確實掩蓋了這種整合層面的問題。

其次，關於「發布」的定義問題，我更擔心的是：如果概念不清楚，我根本不知道要怎麼寫測試。「發布一篇」和「全量同步」是完全不同的測試策略。

**立場**：⚠️ 強烈要求在任何實作繼續之前先確認定義。

---

### 🟨 Morgan（UX）— 使用者體驗視角

**Morgan**：我要先說一件事：使用者不在乎技術細節，他們在乎的是「我按了這個按鈕之後，發生了什麼事」。

現在編輯器上方有「發布到部落格」按鈕——使用者按下去，會預期「這篇文章出現在我的部落格」。如果結果是「全部已發布的文章都被同步了」，這和預期不符，不是好的 UX。

反過來說，如果「發布」是全量同步的概念，按鈕應該在一個全域的地方，而不是在單篇文章的操作區。按鈕的位置本身就在傳達語意。

還有一個問題我想提：使用者怎麼在 WriteFlow 裡改文章的 status？目前是 frontmatter 編輯器，但那個介面對一般使用者來說不夠直覺。

**立場**：❌ 反對在設計哲學確認之前繼續建構 UI。

---

### 🟦 Alex（PM）— 產品策略視角

**Alex**：聽了大家的說法，我想提出今天最重要的問題——

我們到底是在做什麼工具？

我的理解是：WriteFlow 的目標使用者，很多人已經在用 Obsidian 寫文章了。他們的痛點是「寫完之後要發布到部落格很麻煩」。WriteFlow 的價值就是讓這件事變簡單。

所以 Obsidian 的 vault 不是我們的「老闆」，而是我們的「資料來源」。使用者在 WriteFlow 裡工作，WriteFlow 去讀那些 `.md` 檔案。

基於這個定位，我認為：
- WriteFlow 應該是管理 status 的地方（不是讓使用者去 Obsidian 改 frontmatter）
- 「發布」應該是一個明確的、全域的動作
- 單篇文章的操作應該是「標記為已發布」，不是「發布到部落格」

**立場**：✅ 支持重新定義，並以此為基礎重新設計相關 UI 和流程。

---

## 🔍 Part 3：核心議題討論

---

### 議題 A：WriteFlow 和 Obsidian 的關係定位

**Alex 提問**：Obsidian 是「主人」還是「資料來源」？這個定位影響我們所有的設計決策。

**Morgan 回應**：

這不只是語意的問題。如果 Obsidian 是主人，我們的 UI 就要圍繞「讓使用者繼續在 Obsidian 工作」來設計——WriteFlow 只是一個發布工具。

如果 Obsidian 是資料來源，我們的 UI 就要圍繞「讓使用者在 WriteFlow 完成完整的工作流程」來設計——Obsidian 只是存放 `.md` 檔案的地方。

這兩個方向的 UI 長得完全不一樣。

**Sam 補充**：

從技術角度，Obsidian 是「資料來源」比較合理。我們讀它的 `.md` 檔案，我們也寫回去。使用者可以兩邊操作，但 WriteFlow 才是他們主要的工作介面。

**Jordan 確認**：

那測試的方向也清楚了——WriteFlow 的操作是主要路徑，Obsidian 的直接編輯是相容性場景。

**Alex 結論**：

> **Obsidian 是資料來源，不是主人。WriteFlow 是主工具。**
>
> 選擇讀取 Obsidian vault 的原因是降低轉換成本——使用者不需要搬資料，WriteFlow 直接讀取他們已有的文章庫。

---

### 議題 B：status 欄位怎麼管

**Morgan 提問**：使用者要怎麼在 WriteFlow 裡改文章的 status？

**Alex**：我認為應該有一個明確的 UI 元素，讓使用者可以切換「草稿 / 已發布」。不應該要求使用者去 frontmatter 編輯器裡找 status 欄位手動改。

**Sam**：技術上沒問題。WriteFlow 讀取 status，顯示在 UI 上，使用者切換後寫回 `.md` 的 frontmatter。如果原本的 `.md` 沒有 status 欄位，我們補上去，預設是 draft。

**Jordan 追問**：如果使用者在 Obsidian 直接改了 frontmatter，WriteFlow 怎麼處理？

**Sam**：檔案監聽會重新讀取。WriteFlow 以 `.md` 的內容為準，不維護自己的狀態資料庫。

**Morgan 確認**：

> **共識**：WriteFlow 提供 UI 讓使用者切換 status，並寫回 `.md`。沒有 status 欄位時預設 draft。Obsidian 直接改也合法，WriteFlow 尊重檔案內容。

---

### 議題 C：「發布到部落格」的語意與觸發方式

**Alex 提問**：使用者按「發布到部落格」，應該發生什麼事？

**Morgan**：

我想先說清楚一個概念差異：

「標記為已發布」和「發布到部落格」是兩件不同的事。

- 標記為已發布：改 status 欄位，文章進入「待同步」狀態
- 發布到部落格：把所有 status: published 的文章輸出到 target

現在的問題是，這兩件事被混在一起了。編輯器上方的按鈕叫「發布到部落格」，但使用者預期的語意可能是「標記這篇文章」，也可能是「把這篇推出去」。

**Alex**：

那我們要先決定：發布到部落格是「全量同步」還是「單篇推送」？

**Sam**：

從技術角度，全量同步更簡單也更可靠——不需要追蹤「哪些已同步、哪些沒同步」的狀態。只要掃描所有 published 的文章，全部輸出一次就好。

**Jordan**：

全量同步也比較好測試。單篇推送需要維護同步狀態，這個狀態存在哪裡？放 frontmatter 又多一個欄位，放記憶體就會跟檔案內容不同步。

**Morgan**：

從 UX 的角度，全量同步也對——使用者的心智模型更接近「我準備好了，現在把部落格更新一次」。這就像 git push，不是「push 這一個 commit」，而是「把本地的狀態推上去」。

重點是，這個操作應該放在全域的地方，不是在單篇文章旁邊。

**Morgan（補充）**：那現在編輯器上方和文章列表裡的「發布到部落格」按鈕就要移除。

**Sam**：同意。那些位置應該只有「標記為已發布 / 改回草稿」的切換。

**Alex 結論**：

> **發布到部落格 = 手動觸發的全量同步**
> - 觸發方式：使用者主動按「同步到 Blog」
> - 觸發範圍：所有 status: published 的文章
> - 按鈕位置：全域操作區（非單篇文章的操作區）
> - 單篇文章的操作區只有：標記 status（草稿 ↔ 已發布）

---

### 議題 D：輸出結構

**Sam**：最後還有一個技術問題要確認——輸出到 target 的資料夾結構是什麼？

**Sam 提議**：

使用 Leaf 結構：每篇文章有自己的資料夾，文章和圖片放在一起。

```
{target}/
  文章 slug/
    index.md
    images/
      圖片.png
```

優點是自包含，刪除一篇文章只需要刪資料夾，不影響其他文章的圖片。也比較符合現代靜態網站框架的慣例。

**Jordan**：這個結構也讓測試更簡單——每個 slug 目錄是獨立的，不會有交叉污染。

**Morgan**：從使用者角度沒意見，他們不會直接操作這個資料夾結構。

**Alex 確認**：

> **採用 Leaf 結構**：`{target}/{slug}/index.md` + `{target}/{slug}/images/`

---

## 📊 Part 4：觀點總結

| 角色 | 核心立場 | 最重要的一點 |
|------|---------|------------|
| Alex (PM) | ✅ 支持重新定義 | WriteFlow 是主工具，設計要圍繞這個定位 |
| Sam (Tech Lead) | ⚠️ 確認後支持 | 圖片路徑是 bug，需要修；全量同步技術上更合理 |
| Jordan (QA) | ⚠️ 要求先確認定義 | 定義不清就無法寫測試；mock 測試掩蓋了整合問題 |
| Morgan (UX) | ❌→✅（確認後） | 按鈕位置傳達語意；全量同步符合使用者心智模型 |

---

## 🤝 Part 5：共識與分歧

### 共識點

- WriteFlow 是主工具，Obsidian vault 是資料來源（降低轉換成本的設計選擇）
- status 欄位由 WriteFlow 管理，無 status 時預設 draft
- 「發布到部落格」= 手動觸發的全量同步，不是單篇推送
- 「標記 status」和「觸發同步」是兩個不同的操作
- 輸出採用 Leaf 結構

### 已識別的問題

- 圖片輸出路徑有 bug（需修復）
- E2E_PUBLISH_FLOW.md 與現況不符（需更新）
- 編輯器和文章列表的「發布到部落格」按鈕語意錯誤（需重構）
- 關鍵設計決策過去未文件化（本次補齊）

### 無分歧

本次討論四個角色最終達成完整共識，無遺留分歧。

---

## ✅ Part 6：決策與行動計畫

### 確認的設計決策

| 議題 | 決策 |
|------|------|
| WriteFlow 定位 | 主工具；Obsidian vault 為資料來源 |
| status 缺失時 | 預設 draft |
| status 管理 | WriteFlow 提供 UI 切換，寫回 frontmatter |
| 發布觸發 | 手動按「同步到 Blog」 |
| 發布範圍 | 全量（所有 status: published） |
| 輸出結構 | Leaf 模式：`{slug}/index.md` + `{slug}/images/` |
| target 設定值 | 直接指向 content 資料夾 |

### 行動項目

**文件（立即）**：
- [x] 圓桌會議 #006 記錄
- [x] 新建 `docs/architecture/PUBLISH_DESIGN.md`

**程式碼（待實作）**：
- [ ] `PublishService.ts` — 修正圖片路徑 bug，輸出改為 Leaf 結構
- [ ] `E2E_PUBLISH_FLOW.md` — 更新以反映新設計
- [ ] `EditorHeader.vue` — 移除單篇「發布到部落格」按鈕
- [ ] `ArticleManagement.vue` — 移除列表內單篇發布按鈕
- [ ] 新增全域「同步到 Blog」按鈕（位置待 UX 確認）
- [ ] status 切換 UI（草稿 ↔ 已發布）

---

## 💬 圓桌快語

**Sam**：「我承認那個 bug 是我漏掉的。下次架構改動要同步更新文件，不能只改程式碼。」

**Jordan**：「mock 測試通過不代表整合沒問題。端到端流程要真的跑過一次才算。」

**Morgan**：「按鈕放在哪裡就是在說什麼話。放在編輯器裡就是在說『發布這篇』，使用者會這樣理解。」

**Alex**：「最大的收穫是：設計哲學要在程式碼動之前就說清楚。這次是補課，下次要提前做。」

---

**會議結束時間**: 2026-02-14
**下次檢查點**: 2026-02-18（週日，Week 4 進度確認）
**文檔維護**: Alex Chen (PM)
**版本**: v1.0

---

**相關文件**：
- [圓桌 #005 — Week 3 進度回報](./2026-02-13-week3-progress-review.md)
- [發布設計文件](../architecture/PUBLISH_DESIGN.md)
- [端到端發布流程](../architecture/E2E_PUBLISH_FLOW.md)
