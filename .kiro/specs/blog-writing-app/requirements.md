# 需求文件

## 簡介

本文件規範了一個整合 Obsidian markdown 編輯與 Astro 部落格發布的部落格撰寫應用程式需求。該應用程式使用 Vue3 + TypeScript + Electron 開發，提供統一介面來管理部落格文章的撰寫、預覽、格式轉換，以及將內容部署到基於 Astro 的部落格系統。應用程式整合現有的 Obsidian 到 Astro 轉換工具，並提供本地開發伺服器管理功能。

## 詞彙表

- **部落格撰寫應用程式**: 使用 Vue3 + TypeScript + Electron 開發的桌面應用程式，用於管理部落格內容
- **Obsidian_Vault**: 包含 Obsidian 格式 markdown 檔案的來源目錄，包含 Publish/Drafts/Images 三個資料夾
- **Astro_部落格**: 使用 Astro 框架的目標部落格系統，repo 位於 eanlee.github.io
- **草稿文章**: 儲存在 Obsidian Vault 的 Drafts 資料夾中的未發布文章
- **已發布文章**: 移動到 Publish 資料夾並準備轉換的文章
- **前置資料**: markdown 檔案開頭的 YAML 元資料，包含標題、日期、標籤、slug 等
- **網址代稱**: 部落格文章的 URL 友善識別碼（slug）
- **Markdown_轉換器**: 將 Obsidian 格式轉換為 Astro 格式的元件，基於現有的轉換工具
- **預覽引擎**: 渲染 markdown 內容進行即時預覽的元件
- **開發伺服器管理器**: 管理本地 Astro 開發伺服器（npm run dev）的元件
- **分類管理器**: 管理文章分類（Software、growth、management）的元件
- **圖片管理器**: 管理 Images 資料夾中的圖片資源和引用的元件
- **自動儲存器**: 定期自動儲存編輯內容的元件
- **Blog_目標路徑**: Astro 部落格的文章存放路徑 src/content/blog

## 需求

### 需求 1

**使用者故事：** 身為部落格作者，我希望在統一介面中管理我的文章草稿和已發布內容，以便有效率地組織我的寫作工作流程。

#### 驗收標準

1. 當應用程式啟動時，部落格撰寫應用程式應顯示所有草稿文章和已發布文章的清單
2. 當使用者建立新文章時，部落格撰寫應用程式應將其初始化為具有預設前置資料的草稿文章
3. 當使用者選擇文章時，部落格撰寫應用程式應載入內容供編輯
4. 當使用者將文章從草稿移動到發布時，部落格撰寫應用程式應將檔案從草稿資料夾轉移到發布資料夾
5. 當使用者刪除文章時，部落格撰寫應用程式應從適當的資料夾中移除檔案

### 需求 2

**使用者故事：** 身為部落格作者，我希望透過結構化介面編輯前置資料屬性，以便確保所有文章的元資料一致性。

#### 驗收標準

1. 當編輯文章時，部落格撰寫應用程式應以結構化表單顯示前置資料欄位
2. 當使用者修改標題欄位時，部落格撰寫應用程式應自動產生對應的網址代稱
3. 當使用者儲存前置資料變更時，部落格撰寫應用程式應更新 markdown 檔案中的 YAML 標頭
4. 當產生網址代稱時，部落格撰寫應用程式應將標題轉換為 kebab-case 格式
5. 當網址代稱已存在時，部落格撰寫應用程式應附加數字後綴以確保唯一性
6. 當文章內容被修改時，部落格撰寫應用程式應自動更新 lastmod 欄位為當前日期

### 需求 3

**使用者故事：** 身為部落格作者，我希望預覽我的 markdown 內容在部落格上的顯示效果，以便在發布前驗證格式和版面配置。

#### 驗收標準

1. 當編輯 markdown 內容時，預覽引擎應即時渲染內容
2. 當 markdown 包含 Obsidian wiki 連結時，預覽引擎應顯示轉換後的外觀
3. 當 markdown 包含圖片時，預覽引擎應使用正確的相對路徑顯示圖片
4. 當 markdown 包含程式碼區塊時，預覽引擎應套用語法高亮
5. 當 markdown 包含表格或清單時，預覽引擎應以適當格式渲染

### 需求 4

**使用者故事：** 身為部落格作者，我希望將 Obsidian 格式的文章轉換為 Astro 格式並放置到指定的部落格位置，以便在我的部落格網站上發布。

#### 驗收標準

1. 當使用者點擊「更新 Blog」時，Markdown_轉換器應整合現有的轉換工具處理 Publish 資料夾中的所有文章並將轉換結果放置到 Blog_目標路徑
2. 當轉換 wiki 連結時，Markdown_轉換器應將 [[連結]] 和 [[連結|別名]] 格式轉換為標準 markdown 連結並建立正確的相對路徑
3. 當轉換圖片參照時，Markdown_轉換器應將 ../../images/ 和 ![[圖片.png]] 格式更新為 ./images/ 並建立 Leaf Bundle 結構
4. 當轉換高亮語法時，Markdown_轉換器應將 ==文字== 轉換為 &lt;mark&gt;文字&lt;/mark&gt;
5. 當複製圖片時，Markdown_轉換器應將 Images 資料夾中參照的圖片複製到每篇文章的 images 子目錄並確保路徑正確性

### 需求 5

**使用者故事：** 身為部落格作者，我希望啟動本地部落格開發伺服器，以便在實際部落格環境中測試我的文章。

#### 驗收標準

1. 當使用者點擊「執行 blog」時，開發伺服器管理器應導航到 blog src 目錄並執行 npm run dev 命令
2. 當開發伺服器啟動時，部落格撰寫應用程式應顯示伺服器狀態、URL 和終端輸出
3. 當開發伺服器運行時，部落格撰寫應用程式應提供停止伺服器的控制項
4. 當伺服器遇到錯誤時，部落格撰寫應用程式應顯示錯誤訊息和完整的終端日誌
5. 當使用者關閉應用程式時，部落格撰寫應用程式應自動停止任何運行中的開發伺服器程序

### 需求 6

**使用者故事：** 身為部落格作者，我希望應用程式安全地處理檔案操作，以免因衝突或錯誤而遺失我的工作。

#### 驗收標準

1. 當儲存檔案變更時，部落格撰寫應用程式應在覆寫前建立備份副本
2. 當檔案操作失敗時，部落格撰寫應用程式應顯示清楚的錯誤訊息並維持資料完整性
3. 當多個實例存取相同檔案時，部落格撰寫應用程式應偵測衝突並警告使用者
4. 當應用程式當機時，部落格撰寫應用程式應在重新啟動時復原未儲存的變更
5. 當處理大量檔案時，部落格撰寫應用程式應提供進度指示器

### 需求 7

**使用者故事：** 身為部落格作者，我希望在編輯器中獲得即時的 markdown 語法支援和驗證，以便提升撰寫效率和內容品質。

#### 驗收標準

1. 當編輯 markdown 內容時，部落格撰寫應用程式應提供語法高亮和自動完成功能
2. 當輸入 wiki 連結時，部落格撰寫應用程式應提供現有文章的自動完成建議
3. 當引用圖片時，部落格撰寫應用程式應提供 Images 資料夾中檔案的自動完成
4. 當前置資料格式錯誤時，部落格撰寫應用程式應顯示驗證錯誤並提供修正建議
5. 當儲存文章時，部落格撰寫應用程式應驗證 markdown 語法和圖片引用的有效性

### 需求 8

**使用者故事：** 身為部落格作者，我希望管理文章分類和標籤，以便有效組織我的部落格內容。

#### 驗收標準

1. 當建立或編輯文章時，部落格撰寫應用程式應提供分類選擇介面（Software、growth、management）
2. 當使用者新增標籤時，部落格撰寫應用程式應提供自動完成功能基於現有標籤
3. 當使用者選擇分類時，部落格撰寫應用程式應自動設定對應的資料夾結構
4. 當顯示文章清單時，部落格撰寫應用程式應支援按分類和標籤篩選
5. 當轉換文章時，部落格撰寫應用程式應確保分類對應到正確的目標資料夾

### 需求 9

**使用者故事：** 身為部落格作者，我希望管理文章中使用的圖片資源，以便確保所有圖片正確引用和組織。

#### 驗收標準

1. 當編輯文章時，部落格撰寫應用程式應顯示文章中引用的所有圖片清單
2. 當插入圖片時，部落格撰寫應用程式應提供圖片瀏覽器選擇 images 資料夾中的檔案
3. 當圖片不存在時，部落格撰寫應用程式應在編輯器中標示警告
4. 當上傳新圖片時，部落格撰寫應用程式應將圖片複製到 images 資料夾並插入正確的引用語法
5. 當刪除未使用的圖片時，部落格撰寫應用程式應掃描所有文章確認圖片未被引用

### 需求 10

**使用者故事：** 身為部落格作者，我希望自動儲存我的工作進度，以免意外遺失編輯內容。

#### 驗收標準

1. 當使用者編輯文章內容時，部落格撰寫應用程式應每 30 秒自動儲存變更
2. 當使用者切換到其他文章時，部落格撰寫應用程式應自動儲存當前文章
3. 當自動儲存發生時，部落格撰寫應用程式應顯示儲存狀態指示器
4. 當檔案有未儲存變更時，部落格撰寫應用程式應在文章標題旁顯示修改指示器
5. 當使用者嘗試關閉有未儲存變更的文章時，部落格撰寫應用程式應提示確認

### 需求 11

**使用者故事：** 身為部落格作者，我希望設定應用程式路徑和配置，以便為我的特定部落格設置和偏好自訂工具。

#### 驗收標準

1. 當應用程式首次啟動時，部落格撰寫應用程式應提示使用者設定 Obsidian Vault 路徑和 Astro 部落格 repo 路徑
2. 當使用者修改路徑設定時，部落格撰寫應用程式應驗證 Obsidian Vault 包含 Publish/Drafts/Images 資料夾結構
3. 當配置 Astro 部落格路徑時，部落格撰寫應用程式應驗證目錄包含 src/content/blog 結構且為有效的 Node.js 專案
4. 當設定無效時，部落格撰寫應用程式應顯示具體的驗證錯誤訊息並防止儲存
5. 當重設設定時，部落格撰寫應用程式應清除所有路徑配置並要求重新設定

### 需求 12

**使用者故事：** 身為部落格作者，我希望應用程式能夠解析和顯示現有的文章結構，以便快速瀏覽和管理我的內容。

#### 驗收標準

1. 當載入 Obsidian Vault 時，部落格撰寫應用程式應掃描 Publish 和 Drafts 資料夾並解析所有 markdown 檔案
2. 當顯示文章清單時，部落格撰寫應用程式應按分類（Software、growth、management）組織文章並顯示前置資料資訊
3. 當解析前置資料時，部落格撰寫應用程式應正確處理 YAML 格式並提取標題、日期、標籤等欄位
4. 當檔案結構變更時，部落格撰寫應用程式應自動重新掃描並更新文章清單
5. 當遇到無效的 markdown 或前置資料時，部落格撰寫應用程式應標示錯誤但不中斷載入程序